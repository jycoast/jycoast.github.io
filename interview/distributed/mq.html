<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><title>消息队列 | thinking in programming</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-ecc98728.css" as="style"><link rel="stylesheet" href="/assets/style-ecc98728.css">
    <link rel="modulepreload" href="/assets/app-6a04670c.js"><link rel="modulepreload" href="/assets/mq.html-e69485ea.js"><link rel="modulepreload" href="/assets/mq.html-ba253493.js"><link rel="prefetch" href="/assets/index.html-f7bd1aab.js" as="script"><link rel="prefetch" href="/assets/index.html-4298b9a4.js" as="script"><link rel="prefetch" href="/assets/index.html-031d719d.js" as="script"><link rel="prefetch" href="/assets/index.html-db6dcf70.js" as="script"><link rel="prefetch" href="/assets/index.html-ad31e7bd.js" as="script"><link rel="prefetch" href="/assets/algorithm.html-f0804c06.js" as="script"><link rel="prefetch" href="/assets/data_structure.html-d9635126.js" as="script"><link rel="prefetch" href="/assets/leetcode.html-ef71561c.js" as="script"><link rel="prefetch" href="/assets/index.html-117f2295.js" as="script"><link rel="prefetch" href="/assets/index.html-609c7a0f.js" as="script"><link rel="prefetch" href="/assets/index.html-aabfe33f.js" as="script"><link rel="prefetch" href="/assets/index.html-c5f9bb27.js" as="script"><link rel="prefetch" href="/assets/index.html-40b8013c.js" as="script"><link rel="prefetch" href="/assets/index.html-0a7fca08.js" as="script"><link rel="prefetch" href="/assets/index.html-4e93143e.js" as="script"><link rel="prefetch" href="/assets/index.html-22c1752b.js" as="script"><link rel="prefetch" href="/assets/cyber_security.html-bc3a5848.js" as="script"><link rel="prefetch" href="/assets/Mybatis.html-391b9d35.js" as="script"><link rel="prefetch" href="/assets/Netty.html-61624a7e.js" as="script"><link rel="prefetch" href="/assets/Spring.html-0c466c09.js" as="script"><link rel="prefetch" href="/assets/SpringBoot.html-e69e72e8.js" as="script"><link rel="prefetch" href="/assets/Elasticsearch.html-b905dab9.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-7b01bda2.js" as="script"><link rel="prefetch" href="/assets/Redis.html-f2457db2.js" as="script"><link rel="prefetch" href="/assets/microservice.html-434635ca.js" as="script"><link rel="prefetch" href="/assets/Java_basics.html-cfdd1175.js" as="script"><link rel="prefetch" href="/assets/Java_collections.html-873a2ded.js" as="script"><link rel="prefetch" href="/assets/Java_concurrency.html-b0b69cb9.js" as="script"><link rel="prefetch" href="/assets/Java_network.html-7b5eef11.js" as="script"><link rel="prefetch" href="/assets/Java_virtual_machine.html-a3fda463.js" as="script"><link rel="prefetch" href="/assets/index.html-e91d82b7.js" as="script"><link rel="prefetch" href="/assets/index.html-d19121fe.js" as="script"><link rel="prefetch" href="/assets/index.html-e8579b79.js" as="script"><link rel="prefetch" href="/assets/index.html-62e5c9df.js" as="script"><link rel="prefetch" href="/assets/index.html-e9120597.js" as="script"><link rel="prefetch" href="/assets/index.html-2598a9b2.js" as="script"><link rel="prefetch" href="/assets/index.html-9d96b1c1.js" as="script"><link rel="prefetch" href="/assets/index.html-4a56cc56.js" as="script"><link rel="prefetch" href="/assets/index.html-0a60a409.js" as="script"><link rel="prefetch" href="/assets/index.html-94a199d7.js" as="script"><link rel="prefetch" href="/assets/index.html-ec32e47f.js" as="script"><link rel="prefetch" href="/assets/index.html-697ffc00.js" as="script"><link rel="prefetch" href="/assets/index.html-b3f184e4.js" as="script"><link rel="prefetch" href="/assets/index.html-9e6a583e.js" as="script"><link rel="prefetch" href="/assets/index.html-db57f7a6.js" as="script"><link rel="prefetch" href="/assets/index.html-fc39245a.js" as="script"><link rel="prefetch" href="/assets/index.html-9c4553f7.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-3602552f.js" as="script"><link rel="prefetch" href="/assets/index.html-584a4d13.js" as="script"><link rel="prefetch" href="/assets/index.html-b095ab40.js" as="script"><link rel="prefetch" href="/assets/index.html-bb0c5450.js" as="script"><link rel="prefetch" href="/assets/index.html-291a1908.js" as="script"><link rel="prefetch" href="/assets/algorithm.html-535297ca.js" as="script"><link rel="prefetch" href="/assets/data_structure.html-c7b889fe.js" as="script"><link rel="prefetch" href="/assets/leetcode.html-ca51c500.js" as="script"><link rel="prefetch" href="/assets/index.html-86fff082.js" as="script"><link rel="prefetch" href="/assets/index.html-50430c00.js" as="script"><link rel="prefetch" href="/assets/index.html-2c246763.js" as="script"><link rel="prefetch" href="/assets/index.html-5c86c417.js" as="script"><link rel="prefetch" href="/assets/index.html-65e05c40.js" as="script"><link rel="prefetch" href="/assets/index.html-abaec088.js" as="script"><link rel="prefetch" href="/assets/index.html-692f370f.js" as="script"><link rel="prefetch" href="/assets/index.html-fa228a6a.js" as="script"><link rel="prefetch" href="/assets/cyber_security.html-eaa04a71.js" as="script"><link rel="prefetch" href="/assets/Mybatis.html-1f205d8b.js" as="script"><link rel="prefetch" href="/assets/Netty.html-4e5fa45a.js" as="script"><link rel="prefetch" href="/assets/Spring.html-74dbba90.js" as="script"><link rel="prefetch" href="/assets/SpringBoot.html-babeb913.js" as="script"><link rel="prefetch" href="/assets/Elasticsearch.html-51888685.js" as="script"><link rel="prefetch" href="/assets/MySQL.html-e6fb6265.js" as="script"><link rel="prefetch" href="/assets/Redis.html-86a0bc88.js" as="script"><link rel="prefetch" href="/assets/microservice.html-668c63b3.js" as="script"><link rel="prefetch" href="/assets/Java_basics.html-ac729eb9.js" as="script"><link rel="prefetch" href="/assets/Java_collections.html-a992d886.js" as="script"><link rel="prefetch" href="/assets/Java_concurrency.html-bed8ff5a.js" as="script"><link rel="prefetch" href="/assets/Java_network.html-1312c84c.js" as="script"><link rel="prefetch" href="/assets/Java_virtual_machine.html-6cc92c43.js" as="script"><link rel="prefetch" href="/assets/index.html-863585ac.js" as="script"><link rel="prefetch" href="/assets/index.html-692f816c.js" as="script"><link rel="prefetch" href="/assets/index.html-c406a1e8.js" as="script"><link rel="prefetch" href="/assets/index.html-d3c763ea.js" as="script"><link rel="prefetch" href="/assets/index.html-69604ed7.js" as="script"><link rel="prefetch" href="/assets/index.html-9aa9c7f7.js" as="script"><link rel="prefetch" href="/assets/index.html-7db6d456.js" as="script"><link rel="prefetch" href="/assets/index.html-6965cf2f.js" as="script"><link rel="prefetch" href="/assets/index.html-5e18ee80.js" as="script"><link rel="prefetch" href="/assets/index.html-ca85e29f.js" as="script"><link rel="prefetch" href="/assets/index.html-2f8357d5.js" as="script"><link rel="prefetch" href="/assets/index.html-98c457d4.js" as="script"><link rel="prefetch" href="/assets/index.html-347ce8ce.js" as="script"><link rel="prefetch" href="/assets/index.html-22e61ac2.js" as="script"><link rel="prefetch" href="/assets/index.html-f00911e1.js" as="script"><link rel="prefetch" href="/assets/index.html-a37572ca.js" as="script"><link rel="prefetch" href="/assets/index.html-a53313f4.js" as="script"><link rel="prefetch" href="/assets/404.html-b779be8b.js" as="script"><link rel="prefetch" href="/assets/index-e32a7948.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/mlogo.svg" alt="thinking in programming"><span class="site-name can-hide">thinking in programming</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/interview/" class="router-link-active" aria-label="Java 面试"><!--[--><!--]--> Java 面试 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java 基础"><span class="title">Java 基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java 基础"><span class="title">Java 基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaSE</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/functional_programming/" class="" aria-label="Java函数式编程"><!--[--><!--]--> Java函数式编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/core_technology/" class="" aria-label="Java集合与IO"><!--[--><!--]--> Java集合与IO <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/concurrent_programming/" class="" aria-label="Java并发编程"><!--[--><!--]--> Java并发编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/knowledge_system/" class="" aria-label="Java知识体系合辑"><!--[--><!--]--> Java知识体系合辑 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaEE</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/jndi/" class="" aria-label="JNDI"><!--[--><!--]--> JNDI <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/jmx/" class="" aria-label="JMX"><!--[--><!--]--> JMX <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/rmi/" class="" aria-label="RMi"><!--[--><!--]--> RMi <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/jms/" class="" aria-label="JMS"><!--[--><!--]--> JMS <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/ejb/" class="" aria-label="EJB"><!--[--><!--]--> EJB <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java性能与监控</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/log/" class="" aria-label="Java日志"><!--[--><!--]--> Java日志 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/monitoring/" class="" aria-label="Java监控"><!--[--><!--]--> Java监控 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据结构与算法"><span class="title">数据结构与算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据结构与算法"><span class="title">数据结构与算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/leetcode/data_structure.md" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/leetcode/algorithm.md" class="" aria-label="常用算法"><!--[--><!--]--> 常用算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/leetcode/leetcode.md" class="" aria-label="算法刷题"><!--[--><!--]--> 算法刷题 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>关系型数据库</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/database/mysql/" class="" aria-label="深入浅出MySQL"><!--[--><!--]--> 深入浅出MySQL <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>NoSQL</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/database/redis/" class="" aria-label="深入浅出Redis"><!--[--><!--]--> 深入浅出Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="常用框架"><span class="title">常用框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="常用框架"><span class="title">常用框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/framework/spring_framework/" class="" aria-label="Spring Framework"><!--[--><!--]--> Spring Framework <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_aop/" class="" aria-label="Spring AOP"><!--[--><!--]--> Spring AOP <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_boot/" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_cloud/" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/framework/netty/" class="" aria-label="深入理解Netty"><!--[--><!--]--> 深入理解Netty <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="中间件"><span class="title">中间件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="中间件"><span class="title">中间件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/middleware/jvm/" class="" aria-label="深入理解JVM"><!--[--><!--]--> 深入理解JVM <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/middleware/mq/" class="" aria-label="RocketMQ从实践到原理"><!--[--><!--]--> RocketMQ从实践到原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/middleware/tomcat/" class="" aria-label="Tomcat核心原理"><!--[--><!--]--> Tomcat核心原理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机原理"><span class="title">计算机原理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机原理"><span class="title">计算机原理</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/computer_theory/Os/" class="" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习指南"><span class="title">学习指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习指南"><span class="title">学习指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/study_guide/favorite_article/" class="" aria-label="深度好文"><!--[--><!--]--> 深度好文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/study_guide/study_materials/" class="" aria-label="资料大全"><!--[--><!--]--> 资料大全 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/study_guide/study_path/" class="" aria-label="学习路线"><!--[--><!--]--> 学习路线 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/about/" class="" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/jycoast" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/interview/" class="router-link-active" aria-label="Java 面试"><!--[--><!--]--> Java 面试 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Java 基础"><span class="title">Java 基础</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Java 基础"><span class="title">Java 基础</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaSE</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/functional_programming/" class="" aria-label="Java函数式编程"><!--[--><!--]--> Java函数式编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/core_technology/" class="" aria-label="Java集合与IO"><!--[--><!--]--> Java集合与IO <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/concurrent_programming/" class="" aria-label="Java并发编程"><!--[--><!--]--> Java并发编程 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/knowledge_system/" class="" aria-label="Java知识体系合辑"><!--[--><!--]--> Java知识体系合辑 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>JavaEE</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/jndi/" class="" aria-label="JNDI"><!--[--><!--]--> JNDI <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/jmx/" class="" aria-label="JMX"><!--[--><!--]--> JMX <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/rmi/" class="" aria-label="RMi"><!--[--><!--]--> RMi <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/jms/" class="" aria-label="JMS"><!--[--><!--]--> JMS <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/ejb/" class="" aria-label="EJB"><!--[--><!--]--> EJB <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java性能与监控</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java_basics/log/" class="" aria-label="Java日志"><!--[--><!--]--> Java日志 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java_basics/monitoring/" class="" aria-label="Java监控"><!--[--><!--]--> Java监控 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据结构与算法"><span class="title">数据结构与算法</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据结构与算法"><span class="title">数据结构与算法</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/leetcode/data_structure.md" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/leetcode/algorithm.md" class="" aria-label="常用算法"><!--[--><!--]--> 常用算法 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/leetcode/leetcode.md" class="" aria-label="算法刷题"><!--[--><!--]--> 算法刷题 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>关系型数据库</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/database/mysql/" class="" aria-label="深入浅出MySQL"><!--[--><!--]--> 深入浅出MySQL <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>NoSQL</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/database/redis/" class="" aria-label="深入浅出Redis"><!--[--><!--]--> 深入浅出Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="常用框架"><span class="title">常用框架</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="常用框架"><span class="title">常用框架</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Spring</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/framework/spring_framework/" class="" aria-label="Spring Framework"><!--[--><!--]--> Spring Framework <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_aop/" class="" aria-label="Spring AOP"><!--[--><!--]--> Spring AOP <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_boot/" class="" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/framework/spring_cloud/" class="" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>网络通信</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/framework/netty/" class="" aria-label="深入理解Netty"><!--[--><!--]--> 深入理解Netty <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="中间件"><span class="title">中间件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="中间件"><span class="title">中间件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/middleware/jvm/" class="" aria-label="深入理解JVM"><!--[--><!--]--> 深入理解JVM <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/middleware/mq/" class="" aria-label="RocketMQ从实践到原理"><!--[--><!--]--> RocketMQ从实践到原理 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/middleware/tomcat/" class="" aria-label="Tomcat核心原理"><!--[--><!--]--> Tomcat核心原理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="计算机原理"><span class="title">计算机原理</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="计算机原理"><span class="title">计算机原理</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/computer_theory/Os/" class="" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习指南"><span class="title">学习指南</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习指南"><span class="title">学习指南</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/study_guide/favorite_article/" class="" aria-label="深度好文"><!--[--><!--]--> 深度好文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/study_guide/study_materials/" class="" aria-label="资料大全"><!--[--><!--]--> 资料大全 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/study_guide/study_path/" class="" aria-label="学习路线"><!--[--><!--]--> 学习路线 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/about/" class="" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/jycoast" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">消息队列 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/interview/distributed/mq.html#mq有什么用-有哪些具体的使用场景" class="router-link-active router-link-exact-active sidebar-item" aria-label="ＭＱ有什么用？有哪些具体的使用场景？"><!--[--><!--]--> ＭＱ有什么用？有哪些具体的使用场景？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#如何进行产品选型" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何进行产品选型？"><!--[--><!--]--> 如何进行产品选型？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#如何保证消息不丢失" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何保证消息不丢失？"><!--[--><!--]--> 如何保证消息不丢失？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#如何保证消费幂等性" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何保证消费幂等性?"><!--[--><!--]--> 如何保证消费幂等性? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#mq如何保证消息顺序" class="router-link-active router-link-exact-active sidebar-item" aria-label="MQ如何保证消息顺序?"><!--[--><!--]--> MQ如何保证消息顺序? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#如何保证消息的高效读写" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何保证消息的高效读写?"><!--[--><!--]--> 如何保证消息的高效读写? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#使用mq如何保证分布式事务的最终一致性" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用MQ如何保证分布式事务的最终一致性？"><!--[--><!--]--> 使用MQ如何保证分布式事务的最终一致性？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#如何设计一个mq" class="router-link-active router-link-exact-active sidebar-item" aria-label="如何设计一个MQ？"><!--[--><!--]--> 如何设计一个MQ？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/interview/distributed/mq.html#kafka如何避免重复消费" class="router-link-active router-link-exact-active sidebar-item" aria-label="Kafka如何避免重复消费？"><!--[--><!--]--> Kafka如何避免重复消费？ <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="消息队列" tabindex="-1"><a class="header-anchor" href="#消息队列" aria-hidden="true">#</a> 消息队列</h1><h2 id="mq有什么用-有哪些具体的使用场景" tabindex="-1"><a class="header-anchor" href="#mq有什么用-有哪些具体的使用场景" aria-hidden="true">#</a> ＭＱ有什么用？有哪些具体的使用场景？</h2><p>队列是一种FIFO先进先出的数据结构，而MQ（Message Queue）即消息队列消息，主要作用就是由生产者发送到ＭＱ进行排队，然后由消费者对消息进行处理，具体使用场景如下：</p><ul><li>异步：作用能提高系统的响应速度和吞吐量。</li><li>解耦：服务之间解耦，可以减少服务之间的影响，提高系统的稳定性和可扩展性，另外，解耦之后可以实现数据分发，生产者发送一个消息后，可以由多个消费者来处理。</li><li>削峰：以稳定的系统资源应对突发的流量冲击。</li></ul><p>不过，ＭＱ也有一些缺点：</p><ul><li>系统的可用性降低：一旦ＭＱ宕机，整个服务就会产生影响。</li><li>系统的复杂度提高：引入ＭＱ之后，数据链路就会变得很复杂，并伴随着很多的问题，例如如何保证消息不丢失？消息不会重复调用？怎么保证消息的顺序性？等等</li><li>数据一致性：Ａ系统发消息，需要B、Ｃ两个系统一同处理。如果Ｂ系统处理成功，Ｃ系统处理失败，这就会造成数据一致性的问题。</li></ul><h2 id="如何进行产品选型" tabindex="-1"><a class="header-anchor" href="#如何进行产品选型" aria-hidden="true">#</a> 如何进行产品选型？</h2><table><thead><tr><th></th><th>Kafka</th><th>RabbitMQ</th><th>RocketMQ</th></tr></thead><tbody><tr><td>优点</td><td>吞吐量非常大，性能非常好，集群高可用</td><td>消息可靠性高，功能全面</td><td>高吞吐，高性能，高可用，功能非常全面</td></tr><tr><td>缺点</td><td>会丢数据，功能比较单一</td><td>吞吐量比较低，消息积累会严重影响性能</td><td>开源版功能不如云上商业版。官方文档和周边生态还不够成熟。客户端只支持Java</td></tr><tr><td>适用场景</td><td>日志分析、大数据采集</td><td>小规模场景</td><td>几乎是全场景</td></tr></tbody></table><h2 id="如何保证消息不丢失" tabindex="-1"><a class="header-anchor" href="#如何保证消息不丢失" aria-hidden="true">#</a> 如何保证消息不丢失？</h2><p>这个问题主要分为两个方面，第一，哪些环节会造成消息丢失？第二，在这些可能会造成消息丢失的场景下，如何保证不丢失。</p><p>总的来说，消息传递过程中如果存在跨网络的请求，或者由IO操作，就有可能会造成消息丢失，具体如下图：</p><img src="https://blog-1304855543.cos.ap-guangzhou.myqcloud.com/blog/img/20210630002742.png" alt="img" style="zoom:67%;"><p>那么如何保证消息不丢失呢？需要按照上面不同场景来单独处理</p><ol><li>生产者发送消息不丢失</li></ol><table><thead><tr><th style="text-align:center;">产品类型</th><th>保证生产者发送消息不丢失策略</th></tr></thead><tbody><tr><td style="text-align:center;">kafka</td><td>消息发送+回调</td></tr><tr><td style="text-align:center;">RocketMQ</td><td>事务消息</td></tr><tr><td style="text-align:center;">RabbitMQ</td><td>消息发送+回调</td></tr><tr><td style="text-align:center;"></td><td>手动事务：Channel：txSelect()开启事务，Channel.txCommit()提交事务，Channel.txRollback()回滚事务，这种方式对channel是会产生阻塞的，造成吞吐量下降</td></tr><tr><td style="text-align:center;"></td><td>publisher confirms。整个处理流程跟RocketMQ的事务消息，基本是一样的。</td></tr></tbody></table><p>具体见下图：</p><p><img src="https://blog-1304855543.cos.ap-guangzhou.myqcloud.com/blog/img/20210630002758.png" alt="img"></p><ol start="2"><li>MQ主从消息同步不丢失</li></ol><table><thead><tr><th>产品类型</th><th>主从消息不丢失策略</th></tr></thead><tbody><tr><td>RoctMQ</td><td>在普通集群中，同步同步、异步同步。异步同步效率更高，但是有丢消息的风险，同步同步就不会丢消息</td></tr><tr><td>Rabbit MQ</td><td>普通集群：消息是分散存储的，节点之间不会主动进行消息同步，是有可能丢失消息的</td></tr><tr><td></td><td>镜像集群：镜像集群会在节点之间主动进行数据同步，这样数据安全性得到提高。</td></tr><tr><td>Kafka</td><td>通常都是用在允许消息少量丢失的场景，可以通过参数配置：acks：0，1，all</td></tr></tbody></table><ol start="3"><li>MQ消息存盘不丢失</li></ol><ul><li><p>RocketMQ：同步刷盘、异步刷盘：异步刷盘效率更高，但是有可能丢消息，同步刷盘消息安全性更高，但是效率会降低。</p></li><li><p>RabbitMQ：将队列配置成持久化队列</p></li></ul><ol start="4"><li>消费者消费消息不丢失</li></ol><ul><li><p>RocketMQ:使用默认的方式消费就行，不要采用异步方式</p></li><li><p>RabbitMQ：autoCommit</p></li><li><p>Kafka：手动提交offset</p></li></ul><h2 id="如何保证消费幂等性" tabindex="-1"><a class="header-anchor" href="#如何保证消费幂等性" aria-hidden="true">#</a> 如何保证消费幂等性?</h2><p>其实就是要防止消费者重复消费的问题。</p><p>所有MQ产品都没有提供主动解决幂等性的机制，需要由消费者自行控制。</p><p>RocketMQ：给每个消息分配了MessagesID，这个MessagesID可以作为消费者判断幂等的依据，这种方式不太建议。</p><p>最好的方式就是自己带一个有业务标识的id，来进行幂等判断，例如在订单中OrderID</p><p>还可以统一ID分配。</p><h2 id="mq如何保证消息顺序" tabindex="-1"><a class="header-anchor" href="#mq如何保证消息顺序" aria-hidden="true">#</a> MQ如何保证消息顺序?</h2><p>消息的顺序分为全局有序和局部有序，通常来说，MQ只需要保证局部有序，不需要保证全局有序。</p><p><img src="https://blog-1304855543.cos.ap-guangzhou.myqcloud.com/blog/img/20210630003411.png" alt="img"></p><p>Java当中对零拷贝进行了封装，Mmap方式通过MappedByteBuffer对象进行操作，而transfer通过FileChannel来进行操作。</p><p>Mmap适合比较小的文件，通常文件大小不要超过1.5G-2G，transfile没有文件大小限制。</p><p>RocketMQ当中使用Mmap方式对它的文件进行读写。</p><p>在Kafka当中，它的index日志文件也是通过Mmap的方式来读写的。在其他的日志文件当中，并没有使用零拷贝的方式，Kafka使用transfile方式将硬盘数据加载到网卡。</p><h2 id="如何保证消息的高效读写" tabindex="-1"><a class="header-anchor" href="#如何保证消息的高效读写" aria-hidden="true">#</a> 如何保证消息的高效读写?</h2><p>零拷贝：Kafka和RocketMQ都是通过零拷贝技术来优化文件读写。</p><p>传统文件复制方式：需要对文件在内存中进行四次拷贝。</p><img src="https://blog-1304855543.cos.ap-guangzhou.myqcloud.com/blog/img/20210630003425.png" alt="img" style="zoom:50%;"><p>零拷贝：有两种方式：mmap和 transfile</p><img src="https://blog-1304855543.cos.ap-guangzhou.myqcloud.com/blog/img/20210630003438.png" alt="img" style="zoom:50%;"><p>Java当中对零拷贝进行了封装，Mmap方式通过MappedByteBuffer对象进行操作，而transfer通过FileChannel来进行操作。</p><p>Mmap适合比较小的文件，通常文件大小不要超过1.5G-2G，transfile没有文件大小限制。</p><p>RocketMQ当中使用Mmap方式对它的文件进行读写。</p><p>在Kafka当中，它的index日志文件也是通过Mmap的方式来读写的。在其他的日志文件当中，并没有使用零拷贝的方式，Kafka使用transfile方式将硬盘数据加载到网卡。</p><h2 id="使用mq如何保证分布式事务的最终一致性" tabindex="-1"><a class="header-anchor" href="#使用mq如何保证分布式事务的最终一致性" aria-hidden="true">#</a> 使用MQ如何保证分布式事务的最终一致性？</h2><p>分布式事务指的是业务相关的多个操作，保证他们同时成功或者同时失败。最终一致性指的是保证事务在最后阶段，能够达到一致性即可，与之对应的就是强一致性。</p><p>MQ中要保护事务的最终一致性，就需要做到两点：</p><ol><li>生产者要保证100%的消息投递（使用事务消息机制）</li><li>消费者这一段需要保证幂等消费（唯一ID + 业务自己实现幂等）</li></ol><p>分布式MQ的三种语义：at least once、at most once、exactly once</p><p>Rocket MQ并不能保证exactly once，商业版本中提供了exactly once的实现机制。</p><p>Kafka：在最新版本的饿源码当中，提供了exactly once的demo。</p><p>RabbitMQ：使用erlang语言天生就成为了一种屏障</p><h2 id="如何设计一个mq" tabindex="-1"><a class="header-anchor" href="#如何设计一个mq" aria-hidden="true">#</a> 如何设计一个MQ？</h2><p>从整体到细节，从业务场景到技术实现，以现产品为基础。具体的设计思路：</p><ul><li>实现单机的队列的数据结构。高效，可扩展</li><li>将单机队列扩展成为分布式队列，分布式集群管理</li><li>基于Topic定制消息路由策略</li><li>实现高效的网络通信 netty - http</li><li>规划日志文件，实现文件告诉读写，零拷贝，顺序写，服务重启后，快速还原运行现场</li><li>定制高级功能，死信队列、延迟队列、事务消息等等，注意贴合实际</li></ul><h2 id="kafka如何避免重复消费" tabindex="-1"><a class="header-anchor" href="#kafka如何避免重复消费" aria-hidden="true">#</a> Kafka如何避免重复消费？</h2></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/jycoast/edit/main/interview/distributed/mq.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: jycoder@163.com">jiyongchao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-6a04670c.js" defer></script>
  </body>
</html>
