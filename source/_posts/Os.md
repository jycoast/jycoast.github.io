---
title: thinking in os
categories:
  - 操作系统
author: 吉永超
date: 2022-08-15 00:00:00
tags:
- C++
- C
---

编写操作系统看起来是一件天方夜谭的事情，但古语有云：天下之事有难易乎？为之，则难者亦易矣；不为，则易者亦难矣。

<!-- more -->

# 操作系统概览

## 什么是操作系统

操作系统是一种运行在内核态的软件。

现代计算机包含处理器、存储器、时钟、磁盘、鼠标、网络接口、打印机以及其他设备。从这个角度看，操作系统的任务是在相互竞争的程序之间有序地空指对处理器、存储器以及其他I/O接口设备的分配。

操作系统所处的位置：

![image.png](https://cdn.nlark.com/yuque/0/2022/png/672829/1660556739463-717771df-82cb-40b1-9952-c14afeec07ca.png)

用户态和内核态：

- 内核态：对所有硬件具有完全的访问权，可以执行机器能够运行的任何指令
- 用户态：只使用机器指令中的一个子集，那些会影响机器的空指或可进行I/O操作的指令，在用户态中的程序是禁止的

## 操作系统分类

模拟计算机、神经计算机、量子计算机以及生化计算机。

## 操作系统的发展史



## 计算机组成原理

操作系统是直接运行在硬件之上的软件，因此，在编写操作系统的过程中，难免的会接触到各种类型的硬件，我们需要对这些硬件有一定的认识，才能更好的完成操作系统。

处理器和存储器之间不断增大的性能差距迫使设计者不断寻找缓解存储器平均访问时间问题的方法，比如多级Cache（《计算机存储与外设第1章》）和超线程技术。

### CPU

CPU的寄存器有几个功能。一些寄存器是高速暂存寄存器，用于保存数据或者数据单元的地址（即指针）。另外一些则是特殊功能寄存器，比如对一个循环的次数进行计数的循环计数器，有的则用来记录处理器的状态。CPU最重要的寄存器是程序计数器（PC），它记录了要执行的下一条指令的地址；也就是说，程序计数器保持对程序执行的跟踪，有时PC也叫指令指针。

CPU寄存器的分类：IR、PC、MAR、MBR。

### 地址总线

组成计算机的各个子系统通过总线连接在一起，数据通过总线从计算机中的一个位置传递到另外一个位置。现有的一些总线，比如PCIe，本身就是一个复杂的子系统。

现代计算机中有多条总线，包括片内总线、功能单元间（比如CPU和存储器间）的总线以及总线之间的总线。

### DRAM

RAM：Random Access Memory，即随机存储器（内存），断电会丢失数据。

https://www.zhihu.com/question/30492703

# 编写MBR

## 计算机的启动过程

### BIOS

BIOS全称：Base Input & Output System，即基本输入输出系统。BIOS本身是个程序，程序执行的入口是）0xFFFF0。

BIOS的主要工作是检测、初始化硬件。BIOS直接硬件提供了的些初始化的功能。另外，BIOS提供了中断向量表，通过“int 中断号”来实现相关的硬件调用，当然，BIOS建立的功能就是对硬件的IO操作，也就是输入输出，但由于内存空间大小的限制，BIOS无法将所有硬件的IO操作都实现的面面俱到，而且也没有必要实现那么多，因此，BIOS会挑一些重要的、保证计算机能运行的那些硬件的基本IO操作就行了。这就是BIOS被称为基本IO系统的原因。

## 地址、section、vstart



## CPU的实模式

